# 10. OpenClaw 개발자 가이드

OpenClaw는 확장성을 핵심 철학으로 설계된 AI 에이전트 플랫폼입니다. 이 가이드는 개발자가 OpenClaw의 아키텍처를 이해하고, 직접 기능을 확장(Skill, Channel, Provider)하는 방법을 안내합니다.

## 1. 프로젝트 구조 및 아키텍처

OpenClaw는 Monorepo 구조를 따르며, 핵심 로직(`src`)과 확장 모듈(`extensions`)이 분리되어 있습니다.

### 1.1 디렉토리 구조
```
openclaw/
├── src/
│   ├── agents/       # AI 에이전트 로직 및 스킬 정의
│   ├── channels/     # 메신저/채널 통합 로직 (Slack, Discord 등)
│   ├── gateway/      # HTTP 요청 처리 및 라우팅 (Hono 기반)
│   ├── plugins/      # 플러그인 시스템 코어
│   ├── providers/    # LLM 및 외부 서비스 연동 (OpenAI, Anthropic 등)
│   └── web/          # 웹 인터페이스 관련 코드
├── extensions/       # 독립적인 플러그인 (예: Discord 봇)
├── scripts/          # 빌드 및 유틸리티 스크립트
└── docs/             # 문서
```

### 1.2 기술 스택
- **Runtime**: Node.js (v22.12.0+)
- **Language**: TypeScript
- **Framework**: Hono (Web Framework), Express (Legacy support)
- **Package Manager**: pnpm
- **Testing**: Vitest
- **Linting**: Biome

## 2. 개발 환경 설정

### 2.1 요구 사항
- Node.js v22.12.0 이상
- pnpm (권장) 또는 npm

### 2.2 설치 및 실행
```bash
# 저장소 클론
git clone https://github.com/your-repo/openclaw.git
cd openclaw

# 의존성 설치
pnpm install

# 개발 서버 실행
pnpm dev

# 빌드
pnpm build
```

## 3. 커스텀 확장 개발 (Tutorials)

OpenClaw는 크게 세 가지 방식으로 확장할 수 있습니다.

### 3.1 Custom Provider (LLM 연동)
새로운 AI 모델이나 API 서비스를 연동하려면 Provider를 추가합니다.

**구현 예시 (`src/providers/my-provider.ts`):**
```typescript
import { z } from "zod";

// 설정 스키마 정의
export const MyProviderConfigSchema = z.object({
  apiKey: z.string().min(1),
  model: z.string().default("my-model-v1"),
});

// Provider 구현
export async function createMyProvider(config: z.infer<typeof MyProviderConfigSchema>) {
  return {
    id: "my-provider",
    name: "My Custom AI",
    // 텍스트 생성 메서드
    generate: async (prompt: string) => {
      // API 호출 로직
      return { text: "Generated response" };
    }
  };
}
```

### 3.2 Custom Channel (메신저 연동)
새로운 메신저 플랫폼(예: KakaoTalk, Line)을 연동하려면 Channel을 구현합니다.

**구현 예시 (`extensions/my-channel/index.ts`):**
```typescript
import { OpenClawPluginApi } from "../../src/plugin-sdk";

export const myChannelPlugin = {
  id: "my-channel",
  name: "My Channel Integration",
  
  register(api: OpenClawPluginApi) {
    api.registerChannel({
      id: "my-channel",
      // 메시지 수신 처리
      onMessage: async (msg) => {
        console.log("Received:", msg.text);
        // 에이전트에게 전달
        await api.runtime.handleMessage({
          text: msg.text,
          channelId: "my-channel",
          userId: msg.userId
        });
      },
      // 메시지 발송 처리
      sendText: async (to, text) => {
        // 메신저 API 호출
        console.log("Sending to", to, ":", text);
      }
    });
  }
};
```

### 3.3 Custom Skill (도구 추가)
에이전트가 사용할 수 있는 새로운 도구(예: 날씨 조회, DB 검색)를 추가합니다.

**구현 예시:**
```typescript
import { AgentTool } from "@mariozechner/pi-agent-core";
import { readStringParam, jsonResult } from "./common.js";

export const weatherTool: AgentTool = {
  name: "get_weather",
  description: "Get current weather for a location",
  parameters: {
    type: "object",
    properties: {
      location: { type: "string", description: "City name" }
    },
    required: ["location"]
  },
  execute: async (params) => {
    const location = readStringParam(params, "location", { required: true });
    // 외부 API 호출
    const temp = 25; 
    return jsonResult({ location, temp, condition: "Sunny" });
  }
};
```

## 4. 테스트 및 배포

### 4.1 테스트 실행
Vitest를 사용하여 단위 테스트를 실행합니다.
```bash
# 전체 테스트 실행
pnpm test

# 특정 파일 테스트
pnpm test src/providers/my-provider.test.ts
```

### 4.2 CI/CD 파이프라인
GitHub Actions를 통해 자동화된 테스트 및 빌드가 수행됩니다.
- `.github/workflows/ci.yml`: PR 시 Lint, Build, Test 수행
- `.github/workflows/docker-release.yml`: Main 브랜치 병합 시 Docker 이미지 빌드 및 배포

## 5. 기여 가이드 (Contributing)

1. Issue 생성 후 작업 내용을 논의합니다.
2. Fork 후 Feature 브랜치(`feat/my-feature`)에서 작업합니다.
3. 테스트 코드를 포함하여 커밋합니다.
4. PR 생성 시 변경 사항을 상세히 기술합니다.
5. CI 체크(Lint, Test)를 통과해야 합니다.

---
*더 자세한 내용은 [GitHub Repository](https://github.com/your-repo/openclaw)를 참고하세요.*
