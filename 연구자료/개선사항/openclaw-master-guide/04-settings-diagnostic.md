# 섹션 4: 세팅 진단 프레임워크

> 작성일: 2026-01-31 | 딥리서치 기반 | 출처 포함

## 자가진단 체크리스트 (20개 항목)

### 🔐 보안 (1~5)
| # | 항목 | 확인 방법 | 기준 | 점수 |
|---|------|-----------|------|------|
| 1 | 게이트웨이 토큰 설정 | `gateway.auth.token` 존재 확인 | 설정됨 = ✅ | /5 |
| 2 | DM 페어링 모드 | `dmPolicy: "pairing"` 확인 | pairing = ✅ | /5 |
| 3 | 샌드박스 모드 | `agents.defaults.sandbox.mode` 확인 | non-main 이상 = ✅ | /5 |
| 4 | 명령어 allowlist | `exec-approvals.json` 확인 | 설정됨 = ✅ | /5 |
| 5 | 보안 감사 통과 | `openclaw security audit --deep` | PASS = ✅ | /5 |

### ⚡ 성능 (6~10)
| # | 항목 | 확인 방법 | 기준 | 점수 |
|---|------|-----------|------|------|
| 6 | 모델 라우팅 | 작업별 모델 분리 설정 | 2개 이상 모델 = ✅ | /5 |
| 7 | 히스토리 제한 | `historyLimit` 설정 | 50 이하 = ✅ | /5 |
| 8 | 동시 처리 제한 | `maxConcurrent` 설정 | 설정됨 = ✅ | /5 |
| 9 | 스킬 최적화 | 불필요 스킬 비활성화 | 활성 스킬 20개 이하 = ✅ | /5 |
| 10 | 타임아웃 설정 | `timeoutSeconds` 설정 | 500초 이하 = ✅ | /5 |

### 💰 비용 (11~15)
| # | 항목 | 확인 방법 | 기준 | 점수 |
|---|------|-----------|------|------|
| 11 | 출력 간결화 지시 | SOUL.md에 간결화 지시 | 포함 = ✅ | /5 |
| 12 | 그룹 멘션 필수 | `requireMention: true` | 설정됨 = ✅ | /5 |
| 13 | 미디어 제한 | `mediaMaxMb` 설정 | 5MB 이하 = ✅ | /5 |
| 14 | 무료 모델 활용 | Gemini 등 무료 티어 설정 | 1개 이상 = ✅ | /5 |
| 15 | DM 히스토리 제한 | `dmHistoryLimit` 설정 | 설정됨 = ✅ | /5 |

### 🏗️ 구조 (16~20)
| # | 항목 | 확인 방법 | 기준 | 점수 |
|---|------|-----------|------|------|
| 16 | SOUL.md 설정 | 페르소나 + 제약조건 정의 | 500자 이상 = ✅ | /5 |
| 17 | USER.md 설정 | 사용자 정보 기입 | 이름+TZ 포함 = ✅ | /5 |
| 18 | MEMORY.md 활용 | 장기 기억 저장 여부 | 내용 있음 = ✅ | /5 |
| 19 | 멀티에이전트 설정 | AGENTS.md 또는 에이전트 분리 | 설정됨 = ✅ | /5 |
| 20 | 백업/버전 관리 | 설정 파일 백업 여부 | 백업 존재 = ✅ | /5 |

---

## 점수 매기기 가이드 (100점 만점)

### 카테고리별 배점

| 카테고리 | 배점 | 세부 기준 |
|---------|:----:|---------|
| **보안** | 25점 | Gateway 토큰(5) + 접근제어(5) + 스킬 검증(5) + 키 관리(5) + 네트워크 보안(5) |
| **프롬프트 품질** | 20점 | 역할 명확성(5) + 말투 일관성(5) + 토큰 효율(5) + 멀티에이전트 역할분리(5) |
| **성능** | 20점 | 응답시간(5) + 작업완료율(5) + 정확도(5) + 스트리밍(5) |
| **도구/스킬** | 15점 | 필요 도구 구비(5) + 불필요 도구 제거(5) + TOOLS.md 정확성(5) |
| **비용 효율** | 10점 | 모델 라우팅(5) + 멀티에이전트 비용관리(5) |
| **모니터링** | 10점 | 로그 설정(5) + 비용 추적(5) |

### 등급 기준

| 총점 | 등급 | 평가 | 권장 조치 |
|------|------|------|-----------|
| 90~100 | S | 최적화 완료 | 유지보수만 필요 |
| 75~89 | A | 잘 설정됨 | 미세 조정 권장 |
| 60~74 | B | 기본 수준 | 성능/비용 최적화 필요 |
| 40~59 | C | 개선 필요 | 보안 + 성능 재설정 권장 |
| 0~39 | D | 위험 | 즉시 보안 감사 + 재설정 필수 |

---

## 성능 벤치마크 기준

### 핵심 KPI 매트릭스

| 메트릭 | 정의 | 목표치 (Good) | 경고 (Warning) | 위험 (Critical) |
|--------|------|:------------:|:--------------:|:---------------:|
| **응답 시간 (단순)** | 일반 질문에 대한 첫 응답까지 | <10초 | 10-30초 | >30초 |
| **응답 시간 (복합)** | 리서치/코드 등 복합 작업 | <60초 | 60-180초 | >180초 |
| **작업 완료율** | 사용자 요청 중 성공적으로 완료된 비율 | >90% | 70-90% | <70% |
| **정확도** | 팩트체크 통과율 / 코드 실행 성공률 | >85% | 60-85% | <60% |
| **토큰 효율성** | 유효 출력 토큰 / 총 사용 토큰 | >60% | 30-60% | <30% |
| **멀티에이전트 오버헤드** | (멀티에이전트 비용 - 싱글에이전트 비용) / 싱글에이전트 비용 | <50% | 50-200% | >200% |
| **컨텍스트 유지** | 대화 10턴 후에도 맥락을 유지하는 비율 | >80% | 50-80% | <50% |
| **사용자 만족도 (BES)** | Bot Engagement Score — 부정적 신호 발생 시 100에서 차감 ([출처](https://www.calabrio.com/wfo/contact-center-ai/key-chatbot-performance-metrics/)) | >80 | 60-80 | <60 |

> **참고**: Chatbot KPI 프레임워크 출처 — [Dialzara](https://dialzara.com/blog/ai-chatbot-kpis-what-to-track-in-2025), [Quickchat AI](https://quickchat.ai/post/chatbot-analytics), [Zoho](https://www.zoho.com/salesiq/chatbot/metrics.html)

### 응답 시간
| 작업 유형 | 기대 응답시간 | 경고 기준 |
|-----------|-------------|-----------|
| 단순 질문 | 2~5초 | 10초 초과 |
| 리서치 (웹 검색 포함) | 10~30초 | 60초 초과 |
| 코드 생성 | 5~15초 | 30초 초과 |
| 멀티에이전트 토론 (1라운드) | 30~60초 | 120초 초과 |
| 파일 생성/편집 | 3~10초 | 20초 초과 |

### 비용 기준 (월간)
| 사용량 | 기대 비용 | 경고 기준 |
|--------|----------|-----------|
| 가벼운 사용 (일 10회) | $10~30 | $50 초과 |
| 보통 사용 (일 30회) | $30~80 | $150 초과 |
| 헤비 사용 (일 100회+) | $80~200 | $300 초과 |
| 멀티에이전트 (4명) | 단독 대비 2~3배 | 4배 초과 |

### 정확도 기준
| 항목 | 기준 |
|------|------|
| 팩트 정확도 | 출처 있는 정보 90% 이상 |
| 코드 실행 성공률 | 첫 시도 80% 이상 |
| 지시 이행률 | 요청 사항 95% 반영 |

---

## 개선점 발견 질문지

아래 질문에 솔직히 답변하면 개선 포인트가 드러납니다.

### 효과성
1. 에이전트에게 요청한 것 중 직접 하는 게 더 빨랐던 적이 얼마나 자주 있는가?
2. 에이전트의 응답을 그대로 사용하는 비율은? (수정 없이)
3. "다시 해줘" / "그게 아니라" 같은 재요청을 얼마나 자주 하는가?

### 효율성
4. 한 번의 요청에 평균 몇 번의 도구 호출이 발생하는가? (과다 호출 = 비효율)
5. 멀티에이전트 토론에서 실질적으로 새로운 관점이 나오는 비율은?
6. 같은 정보를 여러 에이전트에게 반복 설명하고 있지는 않은가?

### 캐릭터/UX
7. 에이전트의 말투/성격이 10번의 대화에서 일관되게 유지되는가?
8. 멀티에이전트 대화를 지켜보는 것이 유용한가, 아니면 지루한가?
9. 팀원 간 "토론"이 진짜 토론처럼 느껴지는가, 아니면 순차적 보고처럼 느껴지는가?

### 보안 관련
1. 봇 토큰이 노출된 적 있는가?
2. 알 수 없는 DM을 처리한 적 있는가?
3. 샌드박스 없이 위험한 명령어를 실행한 적 있는가?
4. exec-approvals.json을 검토한 적 있는가?
5. 정기적으로 `openclaw security audit`를 실행하는가?

### 성능 관련
6. 응답이 느려진 적 있는가? → 히스토리/스킬 수 확인
7. 같은 정보를 반복 검색하는가? → 캐싱/메모리 활용
8. 불필요한 스킬이 로드되고 있는가? → 스킬 정리
9. 그룹에서 불필요한 반응이 있는가? → 멘션 설정 확인
10. 토큰 사용량이 예상보다 높은가? → 출력 간결화 + 히스토리 제한

### 비용 관련
11. 모든 작업에 같은 모델을 쓰고 있는가? → 모델 라우팅
12. 무료 모델을 활용하고 있는가? → Gemini 무료 티어
13. 출력이 필요 이상으로 긴가? → SOUL.md에 간결화 지시
14. API 호출 빈도가 높은가? → 배칭 + 캐싱
15. 구독형 인증을 활용하고 있는가? → OAuth 전환 검토

---

## 일반적인 실수 Top 10 & 해결책

| # | 실수 | 왜 문제인가 | 해결책 |
|---|------|-----------|--------|
| 1 | **AGENTS.md에 모든 것을 때려넣기** | 토큰 낭비, 모순 발생, 모델이 핵심 지시를 놓침 | 역할별 분리. AGENTS.md=워크플로우, SOUL.md=페르소나, TOOLS.md=환경설정 |
| 2 | **보안 설정 미적용** | 스킬을 통한 데이터 유출, 프롬프트 인젝션 취약 ([Cisco 보고서](https://blogs.cisco.com/ai/personal-ai-agents-like-openclaw-are-a-security-nightmare)) | Gateway 토큰 필수, allowFrom 설정, Skill Scanner 실행 |
| 3 | **모든 작업에 가장 비싼 모델 사용** | 단순 번역에 Opus 사용 → 비용 10배 | 작업 복잡도별 모델 라우팅 (단순→Haiku/Sonnet, 복합→Opus) |
| 4 | **멀티에이전트를 무조건 사용** | 단순 질문에도 4개 에이전트 가동 → 비용↑, 속도↓, 품질 향상 미미 | 라운드 스킵 조건 명확화. 단순 작업은 싱글 에이전트 |
| 5 | **스킬을 검증 없이 설치** | molthub에서 인기 스킬이라도 악성 가능 (Cisco가 실증) | 설치 전 Skill Scanner 실행, 코드 리뷰 |
| 6 | **컨텍스트 윈도우 관리 무시** | 대화가 길어지면 초기 지시를 잊음 | 주기적 컨텍스트 요약, 중요 지시를 시스템 프롬프트에 배치 |
| 7 | **에이전트 페르소나의 모호한 정의** | "친절하게" 같은 추상적 지시 → 일관성 없는 응답 | 구체적 말투 예시 5개 이상, 상황별 대응 매뉴얼 제공 |
| 8 | **에러 핸들링 미설계** | 도구 호출 실패 시 무한 재시도 or 침묵 | 타임아웃 설정, 실패 시 사용자 알림 패턴 정의 |
| 9 | **테스트 없이 배포** | 프롬프트 변경 후 예상치 못한 행동 | 변경 전후 동일 입력에 대한 A/B 테스트 ([출처](https://laikatest.com/blogs/reliable-llm-pipelines)) |
| 10 | **로그/모니터링 미설정** | 문제 발생 시 원인 추적 불가 | Gateway 로그 활성화, 비용/응답시간 대시보드 구축 |

### 운영 실수 (추가)

| # | 실수 | 증상 | 해결책 |
|---|------|------|--------|
| 11 | Privacy Mode 미해제 | 그룹에서 봇이 반응 안 함 | `/setprivacy` 비활성화 또는 관리자 설정 |
| 12 | 히스토리 무제한 | 토큰 폭발, 비용 급증 | `historyLimit: 50` 설정 |
| 13 | Bun으로 실행 | WhatsApp/Telegram 오류 | Node로 전환 |
| 14 | DM 오픈 정책 | 스팸 봇 접근 | `dmPolicy: "pairing"` |
| 15 | 설정 백업 없음 | 설정 유실 위험 | Git 또는 정기 백업 |

> 출처: [Botpress Common Mistakes](https://botpress.com/blog/common-chatbot-mistakes), [FastBots](https://fastbots.ai/blog/10-common-chatbot-mistakes-and-how-to-avoid-them), [Alphabin Checklist](https://www.alphabin.co/blog/chatbot-testing-checklist)

---

## 우선순위별 개선 로드맵 템플릿

### Phase 1: 즉시 (1-3일) — 보안 기초

```
□ Gateway 토큰 설정 (없으면 지금 당장)
□ allowFrom 설정으로 접근 제어
□ 설치된 스킬 전수 검토 (Skill Scanner)
□ API 키 노출 여부 점검
□ exec 도구 보안 모드 확인
□ `openclaw security audit --deep` 실행
□ DM 페어링 모드 확인
□ 샌드박스 모드 확인
```

### Phase 2: 단기 (1-2주) — 프롬프트 & 비용 최적화

```
□ AGENTS.md / SOUL.md / TOOLS.md 분리 및 정리
□ 페르소나 말투 예시 보강 (최소 5개)
□ 불필요한 멀티에이전트 호출 제거 (스킵 조건 명확화)
□ 모델 라우팅 설정 (작업별 모델 분리)
□ 히스토리 제한 설정
□ 불필요한 스킬 비활성화
□ SOUL.md에 출력 간결화 지시 추가
□ 그룹 멘션 설정 확인
□ 스트리밍 설정 활성화
□ 응답시간 베이스라인 측정
```

### Phase 3: 중기 (1개월) — 성능 & 모니터링

```
□ 작업 유형별 모델 라우팅 설계
□ 월간 비용 추적 체계 구축
□ 로그 모니터링 설정
□ 멀티에이전트 비용 대비 품질 향상 측정
□ A/B 테스트 파이프라인 (프롬프트 변경 시)
□ 타임아웃 설정 조정
□ 동시 처리 수 최적화
□ 미디어 제한 설정
```

### Phase 4: 장기 (3개월) — 고도화

```
□ 커스텀 스킬 개발 (자주 쓰는 워크플로우 자동화)
□ 멀티에이전트 상호작용 패턴 재설계
□ 사용자 피드백 루프 구축
□ 성능 대시보드 자동화
□ 팀 역할 재정의 및 최적화
□ 정기 백업 자동화
```

---

## 참고 자료

- [Cisco: Personal AI Agents like OpenClaw Are a Security Nightmare](https://blogs.cisco.com/ai/personal-ai-agents-like-openclaw-are-a-security-nightmare)
- [OpenClaw 공식 문서](https://docs.openclaw.ai/)
- [OpenClaw Multi-Agent Routing](https://docs.openclaw.ai/concepts/multi-agent)
- [LLM Reliability Best Practices](https://laikatest.com/blogs/reliable-llm-pipelines)
- [LLM Security Checklist](https://spectralops.io/blog/the-essential-llm-security-checklist/)
- [Chatbot Performance Metrics](https://www.calabrio.com/wfo/contact-center-ai/key-chatbot-performance-metrics/)
- [Chatbot Analytics KPIs](https://quickchat.ai/post/chatbot-analytics)
- [Common Chatbot Mistakes](https://botpress.com/blog/common-chatbot-mistakes)
