# 섹션 6: 스킬빌더 스킬 설계

## 6.1 OpenClaw 스킬 시스템 개요

### 스킬이란?
스킬은 **AI 에이전트의 능력을 확장하는 플러그인**이다. 각 스킬은 다음으로 구성:
- `SKILL.md`: YAML 프론트매터 + 사용 지침 (마크다운)
- 스크립트 파일: 실제 실행 로직 (JS/TS/Shell/Python)
- 선택적: `clawdhub.json` (메타데이터)

### 스킬 로드 우선순위
```
<workspace>/skills (최우선)
    → ~/.openclaw/skills (관리/로컬)
        → 번들 스킬 (최하위)
```

### 기본 SKILL.md 구조
```markdown
---
name: my-skill
description: 내 스킬 설명
metadata: {"openclaw": {"requires": {"bins": ["node"], "env": ["MY_API_KEY"]}}}
---

## 사용법
이 스킬은 {description}을 수행합니다.

### 명령어
node {baseDir}/scripts/main.mjs --action do-something

### 예시
node {baseDir}/scripts/main.mjs --action search --query "검색어"
```

## 6.2 스킬빌더 v1.0 초안

### 목적
**스킬을 만드는 스킬**. 사용자가 자연어로 요구사항을 설명하면, 완성된 스킬 패키지를 생성한다.

### SKILL.md (스킬빌더 자체)
```markdown
---
name: skill-builder
description: OpenClaw 스킬을 자동 생성하는 메타 스킬
metadata: {"openclaw": {"always": true}}
---

## 스킬 빌더 워크플로우

### 1. 요구사항 수집
사용자에게 다음을 확인:
- 스킬 이름
- 핵심 기능 (무엇을 하는 스킬인가?)
- 필요한 외부 도구/API
- 입력/출력 형식

### 2. 스킬 구조 생성
다음 파일을 생성:

```
skills/{skill-name}/
├── SKILL.md          # 프론트매터 + 사용 지침
├── scripts/
│   └── main.mjs      # 메인 로직
├── clawdhub.json     # 메타데이터 (선택)
└── README.md         # 설명 (선택)
```

### 3. SKILL.md 템플릿
```yaml
---
name: {skill-name}
description: {설명}
metadata:
  {"openclaw": {
    "requires": {"bins": [{필요 바이너리}], "env": [{필요 환경변수}]},
    "primaryEnv": "{메인 API 키 변수명}",
    "install": [{설치 방법}]
  }}
---

## 사용법
{자연어 사용 지침}

### 명령어
{실행 명령어 + 파라미터}

### 예시
{구체적 사용 예시}
```

### 4. 스크립트 구현
- Node.js (mjs) 기본
- 에러 핸들링 필수
- 출력은 stdout (에이전트가 읽을 수 있도록)
- 환경변수로 API 키 관리

### 5. 테스트
- `node scripts/main.mjs --help` 동작 확인
- 정상 케이스 테스트
- 에러 케이스 테스트
- 에이전트에서 호출 테스트 (실제 대화)

### 6. 배포
- 워크스페이스 설치: `skills/{name}/` 디렉토리에 배치
- ClawHub 배포: `clawhub sync`
```

## 6.3 스킬 생성 워크플로우

```
사용자: "날씨 알려주는 스킬 만들어줘"
    │
    ▼
[1] 요구사항 분석
    - 기능: 현재 날씨 + 예보
    - API: OpenWeatherMap 또는 wttr.in
    - 입력: 도시명
    - 출력: 온도, 상태, 예보
    │
    ▼
[2] 디렉토리 생성
    skills/my-weather/
    ├── SKILL.md
    └── scripts/weather.mjs
    │
    ▼
[3] SKILL.md 작성
    ---
    name: my-weather
    description: 날씨 정보 조회
    metadata: {"openclaw": {"requires": {"bins": ["node"]}}}
    ---
    ## 사용법
    node {baseDir}/scripts/weather.mjs --city "서울"
    │
    ▼
[4] 스크립트 구현
    // weather.mjs
    const city = process.argv.find(a => a === "--city")
    const res = await fetch(`https://wttr.in/${city}?format=j1`)
    // ... 파싱 + 출력
    │
    ▼
[5] 테스트
    $ node skills/my-weather/scripts/weather.mjs --city "서울"
    서울: 맑음, 2°C, 습도 45%
    │
    ▼
[6] 활성화
    에이전트 재시작 또는 스킬 워처가 자동 감지
```

## 6.4 스킬 테스트 방법 (TDD 방식)

### TDD 워크플로우
```
[1] 테스트 먼저 작성 (Red)
    → 기대 입출력 정의
[2] 스크립트 구현 (Green)
    → 테스트 통과시킴
[3] 리팩토링 (Refactor)
    → 코드 정리, 에러 핸들링 강화
[4] 에이전트 통합 테스트
    → 실제 대화에서 호출 확인
```

### 레벨 1: 단위 테스트 (test.mjs)
```javascript
// skills/my-weather/scripts/test.mjs
import { execSync } from "child_process";

const tests = [
  {
    name: "정상 도시 조회",
    cmd: "node scripts/weather.mjs --city 서울",
    expect: (out) => out.includes("서울") && out.includes("°C"),
  },
  {
    name: "잘못된 도시명",
    cmd: "node scripts/weather.mjs --city zzzzzzz",
    expect: (out) => out.includes("에러") || out.includes("not found"),
  },
  {
    name: "인자 없음 (도움말)",
    cmd: "node scripts/weather.mjs",
    expect: (out) => out.includes("사용법") || out.includes("usage"),
  },
  {
    name: "도시명 공백 포함",
    cmd: 'node scripts/weather.mjs --city "New York"',
    expect: (out) => out.includes("New York") || out.includes("°"),
  },
];

let pass = 0, fail = 0;
for (const t of tests) {
  try {
    const out = execSync(t.cmd, { cwd: process.cwd(), encoding: "utf8", timeout: 10000 });
    if (t.expect(out)) {
      console.log(`✅ ${t.name}`);
      pass++;
    } else {
      console.log(`❌ ${t.name} — 예상과 다른 출력: ${out.slice(0, 100)}`);
      fail++;
    }
  } catch (e) {
    const stderr = e.stderr || e.message;
    if (t.expect(stderr)) {
      console.log(`✅ ${t.name} (에러 케이스 통과)`);
      pass++;
    } else {
      console.log(`❌ ${t.name} — 에러: ${stderr.slice(0, 100)}`);
      fail++;
    }
  }
}
console.log(`\n결과: ${pass}/${pass + fail} 통과`);
process.exit(fail > 0 ? 1 : 0);
```

**실행**:
```bash
cd skills/my-weather && node scripts/test.mjs
```

### 레벨 2: 에이전트 통합 테스트
```
# 텔레그램에서 직접 테스트 — 5가지 시나리오
1. "서울 날씨 알려줘" → 스킬 호출 확인
2. "뉴욕 날씨" → 영문 도시 처리
3. "날씨" (도시 미지정) → 기본값 또는 질문
4. "asdfgh 날씨" → 에러 핸들링
5. "내일 서울 날씨" → 예보 지원 여부
```

### 레벨 3: 스트레스/엣지 케이스
| 테스트 | 기대 결과 |
|--------|----------|
| 잘못된 입력 | 친절한 에러 메시지 |
| API 타임아웃 (10초+) | 타임아웃 안내 |
| 빈 응답 | "결과 없음" 메시지 |
| API 키 누락 | 설정 안내 메시지 |
| 동시 호출 5회 | 모두 정상 응답 |
| 특수문자 입력 | 크래시 없이 처리 |

### 레벨 4: 회귀 테스트 (CI)
```bash
# package.json에 추가
"scripts": {
  "test": "node scripts/test.mjs",
  "test:watch": "nodemon --exec 'node scripts/test.mjs'"
}

# 스킬 변경 시 자동 테스트
npm test
```

## 6.5 스킬 저장/배포 방식

### 로컬 저장
```
~/.openclaw/workspace/skills/{skill-name}/SKILL.md
```

### ClawHub 배포
```bash
# 스킬 등록
clawhub sync --all

# 다른 사용자가 설치
clawhub install {skill-name}
```

### Git 관리
```bash
cd ~/.openclaw/workspace/skills/
git init
git add .
git commit -m "Add weather skill"
git remote add origin https://github.com/user/my-skills.git
git push
```

## 6.6 다른 시스템 스킬 구조 비교

| 항목 | OpenClaw | CrewAI | AutoGen | LangGraph |
|------|----------|--------|---------|-----------|
| **스킬 단위** | SKILL.md + 스크립트 | Python 함수 (@tool) | Python 함수 | 노드 (함수) |
| **정의 방식** | YAML 프론트매터 | 데코레이터 | register_function | StateGraph.add_node |
| **설명 방식** | 마크다운 지침 | docstring | docstring | 코드 내 |
| **게이팅** | bins/env/config 체크 | 없음 | 없음 | 없음 |
| **배포** | ClawHub | pip 패키지 | pip 패키지 | pip 패키지 |
| **격리** | 워크스페이스별 | 없음 | 없음 | 없음 |
| **자동 감지** | 파일 와처 | 수동 등록 | 수동 등록 | 수동 등록 |

### OpenClaw 스킬의 차별점
1. **마크다운 기반**: 코딩 없이 지침만으로 가능
2. **자동 게이팅**: 바이너리/환경변수 체크로 자동 활성화/비활성화
3. **핫 리로드**: 파일 와처로 변경 즉시 반영
4. **에이전트별 격리**: 워크스페이스 스킬은 해당 에이전트만 접근
5. **커뮤니티 생태계**: ClawHub으로 검색/설치/공유

## 6.7 Claude Desktop 스킬 → OpenClaw 변환 가이드

### Claude Desktop 스킬 구조
```
skill-name/
├── skill.json      # 도구 정의 (JSON Schema)
└── index.js        # 구현
```

### OpenClaw 변환 단계

**Step 1**: `skill.json` → `SKILL.md` 프론트매터
```json
// Claude: skill.json
{
  "name": "get_weather",
  "description": "Get current weather",
  "parameters": {
    "properties": {
      "city": { "type": "string" }
    }
  }
}
```
→
```yaml
# OpenClaw: SKILL.md
---
name: get-weather
description: Get current weather
---
## 사용법
node {baseDir}/scripts/weather.mjs --city "{도시명}"
```

**Step 2**: `index.js` → `scripts/main.mjs`
```javascript
// Claude: index.js
export default async function run({ city }) {
  const res = await fetch(`https://api.weather.com/${city}`);
  return await res.json();
}
```
→
```javascript
// OpenClaw: scripts/main.mjs
const args = process.argv.slice(2);
const cityIdx = args.indexOf("--city");
const city = cityIdx >= 0 ? args[cityIdx + 1] : "Seoul";

const res = await fetch(`https://api.weather.com/${city}`);
const data = await res.json();
console.log(JSON.stringify(data, null, 2));
```

**핵심 차이점**:
- Claude: 함수 호출 방식 (JSON 입출력)
- OpenClaw: CLI 방식 (argv 입력, stdout 출력)
- OpenClaw은 `{baseDir}` 변수로 스킬 경로 참조

**Step 3**: 메타데이터 추가
필요한 바이너리, 환경변수, 설치 방법을 `metadata` 필드에 추가.

**Step 4**: 테스트 & 배포
```bash
# 직접 테스트
node scripts/main.mjs --city "서울"

# 에이전트 테스트
# 텔레그램에서 "서울 날씨" 질문
```

## 6.8 개선 제안

1. **타입 안전성**: TypeScript 스크립트 지원 강화
2. **테스트 프레임워크**: 스킬 전용 테스트 러너
3. **의존성 관리**: 스킬별 package.json
4. **버전 관리**: 스킬 버전 + 호환성 체크
5. **시각적 빌더**: GUI로 스킬 생성 (WebChat/macOS 앱 내)
6. **MCP 브릿지**: MCP 서버를 OpenClaw 스킬로 자동 변환
7. **스킬 체이닝**: 스킬 간 파이프라인 정의
8. **A/B 테스트**: 스킬 버전 간 성능 비교

---

## 출처
- [OpenClaw 공식 문서 - Skills](https://docs.openclaw.ai/tools/skills)
- [OpenClaw 공식 문서 - Skills Config](https://docs.openclaw.ai/tools/skills-config)
- [ClawHub](https://clawhub.com)
- [GitHub: openclaw/skills](https://github.com/openclaw/skills)
- [GitHub: openclaw/clawhub](https://github.com/openclaw/clawhub)
- [GitHub: VoltAgent/awesome-openclaw-skills](https://github.com/VoltAgent/awesome-openclaw-skills)
- [AgentSkills 스펙](https://agentskills.io)
- [DataCamp: CrewAI vs LangGraph vs AutoGen](https://www.datacamp.com/tutorial/crewai-vs-langgraph-vs-autogen)
- [Reddit: 500+ Skills](https://www.reddit.com/r/LocalLLM/comments/1qq32b4/)
- [Reddit: 700+ Community Skills](https://www.reddit.com/r/automation/comments/1qr439w/)
